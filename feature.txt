some new feature code by tux
